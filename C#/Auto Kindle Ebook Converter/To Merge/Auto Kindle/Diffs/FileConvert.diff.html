<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- diff html gen, (c) Stephane Rodriguez - feb 2003 -->
<HTML>
<HEAD>
<TITLE> File Diff </TITLE>
<style type='text/css'>
<!--
.N { background-color:white; }
.C { background-color:#FFFFBB; }
.A { background-color:#BBFFBB; }
.D { background-color:#FFBBBB; }
-->
</style>
</HEAD>

<BODY BGCOLOR='#FFFFFF'>

<font size=-1><b>161 changes between the files.</font><br><table border=0 bgcolor=0 cellpadding=1 cellspacing=1 width=100%><tr><td>
<table width=100% bgcolor=white border=0 cellpadding=0 cellspacing=0>
<tr bgColor='#EEEEEE' style='color:0'><td width=50%>old version</td><td width=50%>new version&nbsp;&nbsp;&nbsp;(<b style='background-color:#FFFFBB;width:20'>&nbsp;</b>changed&nbsp;&nbsp;<b style='background-color:#BBFFBB;width:20'>&nbsp;</b>added&nbsp;&nbsp;<b style='background-color:#FFBBBB;width:20'>&nbsp;</b>deleted)&nbsp;&nbsp;<FORM ACTION='' style='display:inline'><SELECT id='fontoptions' onchange='maintable.style.fontSize=this.options[this.selectedIndex].value'><option value='6pt'>6pt<option value='7pt'>7pt<option value='8pt'>8pt<option value='9pt' selected>9pt</SELECT> </FORM></td></tr>
<tr bgColor='#EEEEEE' style='color:0'><td width=50%><code>C:\Auto Kindle\C#\Auto Kindle Ebook Converter\Auto Kindle\FileConvert.cs</code></td><td width=50%><code>C:\Auto Kindle\C#\Auto Kindle Ebook Converter\To Merge\Auto Kindle\FileConvert.cs</code></td></tr></table>
</td></tr>
</table>

<br>

<table border=0 bgcolor=0 cellpadding=1 cellspacing=1 width=100%><tr><td><table id='maintable' width=100% bgcolor='white' cellpadding=0 cellspacing=0 border=0 style='color:#888888;font-family: Courier New, Helvetica, sans-serif; font-size: 8pt'>
<tr><td width=50%><b>0</b> ﻿using System;</td><td width=50%><b>0</b> ﻿using System;</td></tr><tr><td width=50%><b>1</b> using System.Collections.Generic;</td><td width=50%><b>1</b> using System.Collections.Generic;</td></tr><tr><td width=50%><b>2</b> using System.Linq;</td><td width=50%><b>2</b> using System.Linq;</td></tr><tr><td width=50%><b>3</b> using System.Text;</td><td width=50%><b>3</b> using System.Text;</td></tr><tr><td width=50%><b>4</b> using System.IO;</td><td width=50%><b>4</b> using System.IO;</td></tr><tr><td width=50%><b>5</b> using System.Windows.Forms;</td><td width=50%><b>5</b> using System.Windows.Forms;</td></tr><tr><td width=50%><b>6</b> &nbsp;</td><td width=50% class='A'><b>6</b> using System.Windows.Forms;</td></tr><tr><td width=50%><b>7</b> &nbsp;</td><td width=50% class='A'><b>7</b> using Microsoft.VisualBasic;</td></tr><tr><td width=50%><b>8</b> &nbsp;</td><td width=50% class='A'><b>8</b> using System.Xml;</td></tr><tr><td width=50%><b>9</b> &nbsp;</td><td width=50%><b>9</b> &nbsp;</td></tr><tr><td width=50%><b>10</b> namespace Auto_Kindle</td><td width=50%><b>10</b> namespace Auto_Kindle</td></tr><tr><td width=50%><b>11</b> {</td><td width=50%><b>11</b> {</td></tr><tr><td width=50%><b>12</b> &nbsp;&nbsp;&nbsp;&nbsp;class FileConvert</td><td width=50%><b>12</b> &nbsp;&nbsp;&nbsp;&nbsp;class FileConvert</td></tr><tr><td width=50%><b>13</b> &nbsp;&nbsp;&nbsp;&nbsp;{</td><td width=50%><b>13</b> &nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50% class='C'><b>14</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static bool MobiIt(string HTMLFile)</td><td width=50% class='C'><b>14</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static ProcessInformation mobi2mobiApp;</td></tr><tr><td width=50%><b>15</b> &nbsp;</td><td width=50% class='A'><b>15</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static ProcessInformation clitApp;</td></tr><tr><td width=50%><b>16</b> &nbsp;</td><td width=50% class='A'><b>16</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static ProcessInformation pdbApp;</td></tr><tr><td width=50%><b>17</b> &nbsp;</td><td width=50% class='A'><b>17</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static ProcessInformation chmApp;</td></tr><tr><td width=50%><b>18</b> &nbsp;</td><td width=50% class='A'><b>18</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static ProcessInformation pdfApp;</td></tr><tr><td width=50%><b>19</b> &nbsp;</td><td width=50% class='A'><b>19</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static string workingDir;</td></tr><tr><td width=50%><b>20</b> &nbsp;</td><td width=50% class='A'><b>20</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static string tempFolder;</td></tr><tr><td width=50%><b>21</b> &nbsp;</td><td width=50% class='A'><b>21</b> &nbsp;</td></tr><tr><td width=50%><b>22</b> &nbsp;</td><td width=50% class='A'><b>22</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static FileConvert()</td></tr><tr><td width=50%><b>23</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td><td width=50%><b>23</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50% class='C'><b>24</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileLocation mobiFiles = new fileLocation();</td><td width=50% class='C'><b>24</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobi2mobiApp = new ProcessInformation();</td></tr><tr><td width=50% class='C'><b>25</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GatherFileInformation fileHandler = new GatherFileInformation(HTMLFile);</td><td width=50% class='C'><b>25</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clitApp = new ProcessInformation();</td></tr><tr><td width=50% class='C'><b>26</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobiFiles = fileHandler.Getfiles();            </td><td width=50% class='C'><b>26</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdbApp = new ProcessInformation();</td></tr><tr><td width=50% class='C'><b>27</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (mobiFiles.fileExt.ToLower() == "html" || mobiFiles.fileExt.ToLower() == "htm")</td><td width=50% class='C'><b>27</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmApp = new ProcessInformation();</td></tr><tr><td width=50%><b>28</b> &nbsp;</td><td width=50% class='A'><b>28</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfApp = new ProcessInformation();</td></tr><tr><td width=50%><b>29</b> &nbsp;</td><td width=50% class='A'><b>29</b> &nbsp;</td></tr><tr><td width=50%><b>30</b> &nbsp;</td><td width=50% class='A'><b>30</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobi2mobiApp.applicationString = Properties.Settings.Default.mobi2mobiAppPath;</td></tr><tr><td width=50%><b>31</b> &nbsp;</td><td width=50% class='A'><b>31</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobi2mobiApp.applicationSwitch = Properties.Settings.Default.mobi2mobiAppArgs;</td></tr><tr><td width=50%><b>32</b> &nbsp;</td><td width=50% class='A'><b>32</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clitApp.applicationString = Properties.Settings.Default.clitAppPath;</td></tr><tr><td width=50%><b>33</b> &nbsp;</td><td width=50% class='A'><b>33</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clitApp.applicationSwitch = Properties.Settings.Default.clitAppArgs;</td></tr><tr><td width=50%><b>34</b> &nbsp;</td><td width=50% class='A'><b>34</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdbApp.applicationString = Properties.Settings.Default.pdbAppPath;</td></tr><tr><td width=50%><b>35</b> &nbsp;</td><td width=50% class='A'><b>35</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdbApp.applicationSwitch = Properties.Settings.Default.pdfAppArgs;</td></tr><tr><td width=50%><b>36</b> &nbsp;</td><td width=50% class='A'><b>36</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmApp.applicationString = Properties.Settings.Default.chmAppPath;</td></tr><tr><td width=50%><b>37</b> &nbsp;</td><td width=50% class='A'><b>37</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmApp.applicationSwitch = Properties.Settings.Default.chmAppArgs;</td></tr><tr><td width=50%><b>38</b> &nbsp;</td><td width=50% class='A'><b>38</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfApp.applicationString = Properties.Settings.Default.pdfAppPath;</td></tr><tr><td width=50%><b>39</b> &nbsp;</td><td width=50% class='A'><b>39</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfApp.applicationSwitch = Properties.Settings.Default.pdbAppArgs;</td></tr><tr><td width=50%><b>40</b> &nbsp;</td><td width=50% class='A'><b>40</b> &nbsp;</td></tr><tr><td width=50%><b>41</b> &nbsp;</td><td width=50% class='A'><b>41</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;workingDir = GlobalTools.GetexeLocation();</td></tr><tr><td width=50%><b>42</b> &nbsp;</td><td width=50% class='A'><b>42</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempFolder = Properties.Settings.Default.TempPath;</td></tr><tr><td width=50%><b>43</b> &nbsp;</td><td width=50% class='A'><b>43</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>44</b> &nbsp;</td><td width=50% class='A'><b>44</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static bool MobiIt(string InputFile)</td></tr><tr><td width=50%><b>45</b> &nbsp;</td><td width=50% class='A'><b>45</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>46</b> &nbsp;</td><td width=50% class='A'><b>46</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GatherFileInformation fileHandler = new GatherFileInformation(InputFile);</td></tr><tr><td width=50%><b>47</b> &nbsp;</td><td width=50% class='A'><b>47</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (fileHandler.FileInExtension.ToLower() == ".opf")</td></tr><tr><td width=50%><b>48</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td><td width=50%><b>48</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50% class='C'><b>49</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessInformation mobiApp = new ProcessInformation();</td><td width=50% class='C'><b>49</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CleanOpfFile(fileHandler.FileInFullPath);</td></tr><tr><td width=50% class='D'><b>50</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobiApp.applicationString = @"app\mobigen.exe";</td><td width=50%><b>50</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>51</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobiApp.applicationSwitch = null;</td><td width=50%><b>51</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>52</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobiApp.applicationArgString = "\"" + mobiFiles.fileLocationDir + "\\" + mobiFiles.fileName + "." + mobiFiles.fileExt + "\"";</td><td width=50%><b>52</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>53</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteExternalProcessor mobiProcessor = new ExecuteExternalProcessor(mobiApp);</td><td width=50%><b>53</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>54</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!File.Exists(mobiFiles.fileLocationDir + "\\" + mobiFiles.fileName + ".mobi"))</td><td width=50%><b>54</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>55</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td><td width=50%><b>55</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>56</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DialogResult fileConvertFailed = MessageBox.Show("Display Error Information?", "Conversion Failed", MessageBoxButtons.YesNo, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1);</td><td width=50%><b>56</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>57</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (fileConvertFailed == DialogResult.Yes)</td><td width=50%><b>57</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>58</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td><td width=50%><b>58</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>59</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(mobiProcessor.GetapplicationStdOutput());</td><td width=50%><b>59</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>60</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td width=50%><b>60</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>61</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</td><td width=50%><b>61</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>62</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td width=50%><b>62</b> &nbsp;</td></tr><tr><td width=50% class='D'><b>63</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</td><td width=50%><b>63</b> &nbsp;</td></tr><tr><td width=50%><b>64</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td width=50%><b>64</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50% class='C'><b>65</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</td><td width=50% class='C'><b>65</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessInformation mobiApp = new ProcessInformation();</td></tr><tr><td width=50%><b>66</b> &nbsp;</td><td width=50% class='A'><b>66</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobiApp.applicationString = Properties.Settings.Default.MobigenPath;</td></tr><tr><td width=50%><b>67</b> &nbsp;</td><td width=50% class='A'><b>67</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobiApp.applicationSwitch = null;</td></tr><tr><td width=50%><b>68</b> &nbsp;</td><td width=50% class='A'><b>68</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobiApp.applicationArgString = fileHandler.FileInEscaped;</td></tr><tr><td width=50%><b>69</b> &nbsp;</td><td width=50% class='A'><b>69</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteExternalProcessor mobiProcessor = new ExecuteExternalProcessor(mobiApp);</td></tr><tr><td width=50%><b>70</b> &nbsp;</td><td width=50% class='A'><b>70</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!File.Exists(fileHandler.FileInLocation + "\\" + fileHandler.FileInNameNoExtension + ".mobi"))</td></tr><tr><td width=50%><b>71</b> &nbsp;</td><td width=50% class='A'><b>71</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>72</b> &nbsp;</td><td width=50% class='A'><b>72</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DialogResult fileConvertFailed = MessageBox.Show("Display Error Information?", "Conversion Failed", MessageBoxButtons.YesNo, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1);</td></tr><tr><td width=50%><b>73</b> &nbsp;</td><td width=50% class='A'><b>73</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (fileConvertFailed == DialogResult.Yes)</td></tr><tr><td width=50%><b>74</b> &nbsp;</td><td width=50% class='A'><b>74</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>75</b> &nbsp;</td><td width=50% class='A'><b>75</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(mobiProcessor.GetapplicationStdOutput());</td></tr><tr><td width=50%><b>76</b> &nbsp;</td><td width=50% class='A'><b>76</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>77</b> &nbsp;</td><td width=50% class='A'><b>77</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;</td></tr><tr><td width=50%><b>78</b> &nbsp;</td><td width=50% class='A'><b>78</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>79</b> &nbsp;</td><td width=50% class='A'><b>79</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;</td></tr><tr><td width=50%><b>80</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td width=50%><b>80</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>81</b> &nbsp;</td><td width=50% class='A'><b>81</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private static void CleanOpfFile(string FilePath)</td></tr><tr><td width=50%><b>82</b> &nbsp;</td><td width=50% class='A'><b>82</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>83</b> &nbsp;</td><td width=50% class='A'><b>83</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try</td></tr><tr><td width=50%><b>84</b> &nbsp;</td><td width=50% class='A'><b>84</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>85</b> &nbsp;</td><td width=50% class='A'><b>85</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument doc = new XmlDocument();</td></tr><tr><td width=50%><b>86</b> &nbsp;</td><td width=50% class='A'><b>86</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.Load(FilePath);</td></tr><tr><td width=50%><b>87</b> &nbsp;</td><td width=50% class='A'><b>87</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNamespaceManager nsmgr = new XmlNamespaceManager(doc.NameTable);</td></tr><tr><td width=50%><b>88</b> &nbsp;</td><td width=50% class='A'><b>88</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nsmgr.AddNamespace("dc", "http://purl.org/dc/elements/1.0/");</td></tr><tr><td width=50%><b>89</b> &nbsp;</td><td width=50% class='A'><b>89</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nsmgr.AddNamespace("oebpackage", "http://openebook.org/namespaces/oeb-package/1.0/");</td></tr><tr><td width=50%><b>90</b> &nbsp;</td><td width=50% class='A'><b>90</b> &nbsp;</td></tr><tr><td width=50%><b>91</b> &nbsp;</td><td width=50% class='A'><b>91</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (doc.SelectSingleNode("//dc:Language", nsmgr) == null)</td></tr><tr><td width=50%><b>92</b> &nbsp;</td><td width=50% class='A'><b>92</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>93</b> &nbsp;</td><td width=50% class='A'><b>93</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlElement metdataElement = (XmlElement)doc.DocumentElement.SelectSingleNode("//oebpackage:dc-metadata", nsmgr);</td></tr><tr><td width=50%><b>94</b> &nbsp;</td><td width=50% class='A'><b>94</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlElement languageElement = doc.CreateElement("dc", "Language", nsmgr.LookupNamespace("dc"));</td></tr><tr><td width=50%><b>95</b> &nbsp;</td><td width=50% class='A'><b>95</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;languageElement.InnerText = "en-us";</td></tr><tr><td width=50%><b>96</b> &nbsp;</td><td width=50% class='A'><b>96</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metdataElement.AppendChild(languageElement);</td></tr><tr><td width=50%><b>97</b> &nbsp;</td><td width=50% class='A'><b>97</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using (XmlTextWriter xtw = new XmlTextWriter(FilePath, Encoding.Default))</td></tr><tr><td width=50%><b>98</b> &nbsp;</td><td width=50% class='A'><b>98</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>99</b> &nbsp;</td><td width=50% class='A'><b>99</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.WriteContentTo(xtw);</td></tr><tr><td width=50%><b>100</b> &nbsp;</td><td width=50% class='A'><b>100</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xtw.Flush();</td></tr><tr><td width=50%><b>101</b> &nbsp;</td><td width=50% class='A'><b>101</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xtw.Close();</td></tr><tr><td width=50%><b>102</b> &nbsp;</td><td width=50% class='A'><b>102</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>103</b> &nbsp;</td><td width=50% class='A'><b>103</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>104</b> &nbsp;</td><td width=50% class='A'><b>104</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>105</b> &nbsp;</td><td width=50% class='A'><b>105</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch</td></tr><tr><td width=50%><b>106</b> &nbsp;</td><td width=50% class='A'><b>106</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ </td></tr><tr><td width=50%><b>107</b> &nbsp;</td><td width=50% class='A'><b>107</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>108</b> &nbsp;</td><td width=50% class='A'><b>108</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>109</b> &nbsp;</td><td width=50% class='A'><b>109</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static void ConvertFile(GatherFileInformation filehandler)</td></tr><tr><td width=50%><b>110</b> &nbsp;</td><td width=50% class='A'><b>110</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>111</b> &nbsp;</td><td width=50% class='A'><b>111</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (filehandler.FileInExtension.ToLower())</td></tr><tr><td width=50%><b>112</b> &nbsp;</td><td width=50% class='A'><b>112</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>113</b> &nbsp;</td><td width=50% class='A'><b>113</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ".htm":</td></tr><tr><td width=50%><b>114</b> &nbsp;</td><td width=50% class='A'><b>114</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ".html":</td></tr><tr><td width=50%><b>115</b> &nbsp;</td><td width=50% class='A'><b>115</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (FileConvert.MobiIt(filehandler.FileInName))</td></tr><tr><td width=50%><b>116</b> &nbsp;</td><td width=50% class='A'><b>116</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>117</b> &nbsp;</td><td width=50% class='A'><b>117</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GlobalTools.MoveFile(filehandler.FileInLocation + "\\" + filehandler.FileInNameNoExtension + ".mobi", filehandler.FileOutLocation + "\\" + filehandler.FileInNameNoExtension + ".mobi");</td></tr><tr><td width=50%><b>118</b> &nbsp;</td><td width=50% class='A'><b>118</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>119</b> &nbsp;</td><td width=50% class='A'><b>119</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//mobiApp.applicationArgString = filehandler.FileInEscaped;</td></tr><tr><td width=50%><b>120</b> &nbsp;</td><td width=50% class='A'><b>120</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ExecuteExternalProcessor mobiProcessor = new ExecuteExternalProcessor(mobiApp);</td></tr><tr><td width=50%><b>121</b> &nbsp;</td><td width=50% class='A'><b>121</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr><tr><td width=50%><b>122</b> &nbsp;</td><td width=50% class='A'><b>122</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ".mobi":</td></tr><tr><td width=50%><b>123</b> &nbsp;</td><td width=50% class='A'><b>123</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string newTitle = Interaction.InputBox("Enter a New Title for This Book", "MetaData Manipulation", filehandler.FileInName, 100, 100);</td></tr><tr><td width=50%><b>124</b> &nbsp;</td><td width=50% class='A'><b>124</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobi2mobiApp.applicationArgString = @"--title " + "\"" + newTitle + "\" " + filehandler.FileInEscaped + @" --outfile " + filehandler.FileInEscaped;</td></tr><tr><td width=50%><b>125</b> &nbsp;</td><td width=50% class='A'><b>125</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteExternalProcessor mobi2mobiProcessor = new ExecuteExternalProcessor(mobi2mobiApp);</td></tr><tr><td width=50%><b>126</b> &nbsp;</td><td width=50% class='A'><b>126</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr><tr><td width=50%><b>127</b> &nbsp;</td><td width=50% class='A'><b>127</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ".pdb":</td></tr><tr><td width=50%><b>128</b> &nbsp;</td><td width=50% class='A'><b>128</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdbApp.applicationArgString = filehandler.FileInEscaped + " \"" + tempFolder + filehandler.FileInName + ".html\" \"1\"";</td></tr><tr><td width=50%><b>129</b> &nbsp;</td><td width=50% class='A'><b>129</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//MessageBox.Show(pdbApp.applicationArgString);</td></tr><tr><td width=50%><b>130</b> &nbsp;</td><td width=50% class='A'><b>130</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteExternalProcessor pdbProcessor = new ExecuteExternalProcessor(pdbApp);</td></tr><tr><td width=50%><b>131</b> &nbsp;</td><td width=50% class='A'><b>131</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (FileConvert.MobiIt(tempFolder + filehandler.FileInName + ".html"))</td></tr><tr><td width=50%><b>132</b> &nbsp;</td><td width=50% class='A'><b>132</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>133</b> &nbsp;</td><td width=50% class='A'><b>133</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GlobalTools.MoveFile(filehandler.FileInLocation + "\\" + filehandler.FileInName + ".mobi", filehandler.FileOutLocation + "\\" + filehandler.FileInName + ".mobi");</td></tr><tr><td width=50%><b>134</b> &nbsp;</td><td width=50% class='A'><b>134</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>135</b> &nbsp;</td><td width=50% class='A'><b>135</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr><tr><td width=50%><b>136</b> &nbsp;</td><td width=50% class='A'><b>136</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ".lit":</td></tr><tr><td width=50%><b>137</b> &nbsp;</td><td width=50% class='A'><b>137</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string outPath = filehandler.TempLocation + filehandler.FileInNameNoExtension.Replace("'", "");</td></tr><tr><td width=50%><b>138</b> &nbsp;</td><td width=50% class='A'><b>138</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!Directory.Exists(outPath))</td></tr><tr><td width=50%><b>139</b> &nbsp;</td><td width=50% class='A'><b>139</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>140</b> &nbsp;</td><td width=50% class='A'><b>140</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Directory.CreateDirectory(outPath);</td></tr><tr><td width=50%><b>141</b> &nbsp;</td><td width=50% class='A'><b>141</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>142</b> &nbsp;</td><td width=50% class='A'><b>142</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clitApp.applicationArgString = "\"" + filehandler.FileInFullPath + "\" \"" + outPath + "\"";</td></tr><tr><td width=50%><b>143</b> &nbsp;</td><td width=50% class='A'><b>143</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteExternalProcessor litProcessor = new ExecuteExternalProcessor(clitApp);</td></tr><tr><td width=50%><b>144</b> &nbsp;</td><td width=50% class='A'><b>144</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (GlobalTools.FileExist(outPath + "\\" + filehandler.FileInNameNoExtension + ".opf"))</td></tr><tr><td width=50%><b>145</b> &nbsp;</td><td width=50% class='A'><b>145</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>146</b> &nbsp;</td><td width=50% class='A'><b>146</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (FileConvert.MobiIt(outPath + "\\" + filehandler.FileInNameNoExtension + ".opf"))</td></tr><tr><td width=50%><b>147</b> &nbsp;</td><td width=50% class='A'><b>147</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>148</b> &nbsp;</td><td width=50% class='A'><b>148</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GlobalTools.MoveFile(outPath + "\\" + filehandler.FileInNameNoExtension + ".mobi", filehandler.FileOutLocation + "\\" + filehandler.FileInNameNoExtension + ".mobi");</td></tr><tr><td width=50%><b>149</b> &nbsp;</td><td width=50% class='A'><b>149</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>150</b> &nbsp;</td><td width=50% class='A'><b>150</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>151</b> &nbsp;</td><td width=50% class='A'><b>151</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</td></tr><tr><td width=50%><b>152</b> &nbsp;</td><td width=50% class='A'><b>152</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>153</b> &nbsp;</td><td width=50% class='A'><b>153</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(litProcessor.GetapplicationErrorOutput(), "Lit Convert Failed");</td></tr><tr><td width=50%><b>154</b> &nbsp;</td><td width=50% class='A'><b>154</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>155</b> &nbsp;</td><td width=50% class='A'><b>155</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr><tr><td width=50%><b>156</b> &nbsp;</td><td width=50% class='A'><b>156</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ".chm":</td></tr><tr><td width=50%><b>157</b> &nbsp;</td><td width=50% class='A'><b>157</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (filehandler.FileInEscaped == "1")</td></tr><tr><td width=50%><b>158</b> &nbsp;</td><td width=50% class='A'><b>158</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>159</b> &nbsp;</td><td width=50% class='A'><b>159</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmApp.applicationArgString = filehandler.FileInEscaped + " \"" + tempFolder + "\"";</td></tr><tr><td width=50%><b>160</b> &nbsp;</td><td width=50% class='A'><b>160</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteExternalProcessor chmProcessor = new ExecuteExternalProcessor(chmApp);</td></tr><tr><td width=50%><b>161</b> &nbsp;</td><td width=50% class='A'><b>161</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>162</b> &nbsp;</td><td width=50% class='A'><b>162</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr><tr><td width=50%><b>163</b> &nbsp;</td><td width=50% class='A'><b>163</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ".pdf":</td></tr><tr><td width=50%><b>164</b> &nbsp;</td><td width=50% class='A'><b>164</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfApp.applicationArgString = filehandler.FileInEscaped + " \"" + filehandler.TempLocation + "\\" + filehandler.FileInNameNoExtension +"\"";</td></tr><tr><td width=50%><b>165</b> &nbsp;</td><td width=50% class='A'><b>165</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteExternalProcessor pdfProcessor = new ExecuteExternalProcessor(pdfApp);</td></tr><tr><td width=50%><b>166</b> &nbsp;</td><td width=50% class='A'><b>166</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (FileConvert.MobiIt(tempFolder + "\\" + filehandler.FileInNameNoExtension + "s.html"))</td></tr><tr><td width=50%><b>167</b> &nbsp;</td><td width=50% class='A'><b>167</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr><tr><td width=50%><b>168</b> &nbsp;</td><td width=50% class='A'><b>168</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GlobalTools.MoveFile(tempFolder + "\\" + filehandler.FileInNameNoExtension + "s.mobi", filehandler.FileOutLocation + "\\" + filehandler.FileInNameNoExtension + ".mobi");</td></tr><tr><td width=50%><b>169</b> &nbsp;</td><td width=50% class='A'><b>169</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>170</b> &nbsp;</td><td width=50% class='A'><b>170</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr><tr><td width=50%><b>171</b> &nbsp;</td><td width=50% class='A'><b>171</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:</td></tr><tr><td width=50%><b>172</b> &nbsp;</td><td width=50% class='A'><b>172</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show("File type not supported", "Not Supported");</td></tr><tr><td width=50%><b>173</b> &nbsp;</td><td width=50% class='A'><b>173</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td></tr><tr><td width=50%><b>174</b> &nbsp;</td><td width=50% class='A'><b>174</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>175</b> &nbsp;</td><td width=50% class='A'><b>175</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>176</b> &nbsp;&nbsp;&nbsp;&nbsp;}</td><td width=50%><b>176</b> &nbsp;&nbsp;&nbsp;&nbsp;}</td></tr><tr><td width=50%><b>177</b> }</td><td width=50%><b>177</b> }</td></tr></table></td></tr></table>
<br><font size='-2' color='#BBBBBB'>S.Rodriguez, May 2003</font></BODY>
</HTML>
